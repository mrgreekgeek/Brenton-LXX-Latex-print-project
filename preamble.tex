% !TeX program = lualatex
% Layout
\documentclass[9pt,openany]{book}
\usepackage[paperwidth=6.5in,paperheight=9.5in,top=0.3in,bottom=0.7in,left=0.4in,right=0.4in,bindingoffset=0.2in,includehead,headsep=7pt]{geometry}
\usepackage{setspace} % for line spacing
\usepackage{microtype} % helps with formatting
\usepackage{emptypage}
\usepackage[greek]{babel}
\usepackage[all]{nowidow}
\usepackage{ragged2e} % Nicer ragged edges. Use \Center to get nice balanced lines
\usepackage{bookmark} %add PDF bookmarks for each \chapter
\usepackage{hyperref} % Make the TOC clickable
\usepackage{fontspec}
\setmainfont{Gentium Plus}

% % Use a different font for Greek (with Latin fallback)
% % https://tex.stackexchange.com/a/619560/319804
% \directlua{luaotfload.add_fallback("myfallback",{"Gentium Plus:mode=harf;",})}
% \setmainfont{GFS Porson}[RawFeature={fallback=myfallback}]

\flushbottom
\frenchspacing % stops extra space after a period or colon
\hyphenpenalty=2000
\emergencystretch=1pt
\setlength{\parindent}{.2in} % Set paragraph indentation

\usepackage{titlesec}
\renewcommand{\thechapter}{} % remove numbers from chapter
% Show chapter titles with a line after them
\titleformat{\chapter}[display]
{\filcenter\normalfont\Huge}{}{0pt}{}
[\vspace{.5ex}\rule{1.5in}{0.4pt}]

% Add the multicol package for two-column layout
\usepackage{multicol}
\setlength{\columnsep}{.4cm} % Set the columnn width

% Adjust spacing and format of TOC 
\usepackage{tocloft}
\renewcommand{\cftchapfont}{\normalfont} % Set chapter entries to normal font
\renewcommand{\cftchappagefont}{\normalfont} % Set chapter page numbers to normal font
\renewcommand{\cftdotsep}{2} % change the default spacing of dots
\renewcommand{\cftchapleader}{\cftdotfill{\cftdotsep}} % Add leader dots for chapters
\setlength{\cftbeforechapskip}{1pt} % Adjust the space before each TOC chapter entry

% Adjust the width of the TOC
\renewcommand{\cftchapafterpnum}{\hspace*{9em}} % increase right margin
\setlength{\cftchapindent}{9em} % increase left margin
\setlength{\cftchapnumwidth}{0em} % remove space reserved for chapter numbers

% Change the title for the TOC
% https://tex.stackexchange.com/a/28518/319804
\addto\captionsgreek{%
  \renewcommand{\contentsname}%
    {Order of Books}%
}

% Center the TOC title
\renewcommand{\cfttoctitlefont}{\hfill\huge}
\renewcommand{\cftaftertoctitle}{\hfill\hfill}

\newcommand{\psalmheading}[1]{%
    \begin{Center}%
        {#1}%
    \end{Center}%
}

% Set up chapter/verse references in headers
% https://tex.stackexchange.com/a/657575/319804
\usepackage{fancyhdr}
\pagestyle{fancy}
\newcounter{mychapter}
\newcounter{verse}
\def\book{}
\fancyhead{}
\fancyhead[LE]{\rightmark}
\fancyhead[OR]{\leftmark}
\fancyfoot{}
\fancyfoot[C]{\thepage}
\renewcommand{\headrulewidth}{0pt}

\newcommand{\ch}[1]{%
  \setcounter{mychapter}{#1}%
  \markboth{\book\ \themychapter:1}{\book\ \themychapter:1}%
  \textbf{#1}%
}
\newcommand{\vs}[1]{%
  \textsuperscript{#1}%
  \markboth{\book\ \themychapter:#1}{\book\ \themychapter:#1}%
}

\let\biblebook\chapter % rename \chapter so it's not confusing

\newenvironment{psalmhead}[1]{%
    \par\addvspace{\baselineskip}%
    \noindent%
    \begin{minipage}[b]{\columnwidth}%
        \begin{Center}%
            {#1}%
        \end{Center}%
}{%
    \end{minipage}%
}